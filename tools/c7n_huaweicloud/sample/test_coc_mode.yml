policies:
  - name: Huawei_COC_001_Timer_Trigger
    resource: huaweicloud.coc-script
    mode:
      type: huaweicloud-periodic
      xrole: fgs_default_agency
      enable_lts_log: true
      log_level: INFO
      user_data_encrypt_kms_key_id: ""
      code_encrypt_kms_key_id: ""
      func_vpc:
        vpc_name: "vpc-default"
        subnet_name: "subnet-default"
        cidr: "192.168.0.0/24"
      schedule: "0 55 23 * * *"
      schedule_type: Cron
      cron_tz: "America/Sao_Paulo"
    filters:
      - script_non_reviewer_filter
    actions:
      - type: script_non_reviewer_alarm
        topic_urn_list:
          - 'urn:smn:cn-north-4:ce8476c174f94c6991ea7885e3380d99:itau'
        subject: 'Script Security Non-Compliance Alert'
        message: "Alert by Huawei_COC_001_Timer_Trigger : No approver is set for the script. Please handle it in time."