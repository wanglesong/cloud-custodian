policies:
  - name: non-compliant-patch-alarm
    resource: huaweicloud.coc-patch
    filters:
      - type: value
        key: status
        value: 'non_compliant'
        op: eq
      - type: value
        key: report_scene
        value: 'ECS'
        op: eq
      - type: value
        key: operating_system
        value: 'CentOS'
        op: eq
      - type: value
        key: region
        value: 'cn-north-4'
        op: eq
    actions:
      - type: patch_non_compliant_alarm
        topic_urn_list:
          - 'urn:smn:cn-north-4:xxxxx:custodian_test'
        subject: 'Machine Non-compliant Patch Version Alert'
        message: 'There are machines with non compliant patch versions installed under your account'
  - name: script-non-reviewer-alarm
    resource: huaweicloud.coc-script
    filters:
      - script_non_reviewer_filter
    actions:
      - type: script_non_reviewer_alarm
        topic_urn_list:
          - 'urn:smn:cn-north-4:xxxxx:custodian_test'
        subject: 'Script Security Non-Compliance Alert'
        message: 'The following script has been found to lack an assigned reviewer, '
                 'which constitutes a security non-compliance. Please promptly assign a reviewer.'