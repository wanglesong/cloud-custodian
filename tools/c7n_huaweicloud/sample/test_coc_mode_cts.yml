policies:
  - name: Huawei_COC_002_Cts_Trigger
    resource: huaweicloud.coc-script
    mode:
      type: cloudtrace
      xrole: fgs_default_agency
      enable_lts_log: true
      log_level: INFO
      user_data_encrypt_kms_key_id: ""
      code_encrypt_kms_key_id: ""
      func_tags:
        - key: "owner-team-email"
          value: "${func_tag_owner_team_email}"
        - key: "tech-team-email"
          value: "${func_tag_tech_team_email}"
      func_vpc:
        vpc_name: "vpc-default"
        subnet_name: "subnet-default"
        cidr: "192.168.0.0/24"
      events:
        - source: "COC.document"
          event: "CreateScript"
          ids: "resource_id"
          code: 200
        - source: "COC.document"
          event: "UpdateScript"
          ids: "resource_id"
          code: 200
    filters:
      - type: value
        key: properties.reviewers
        value: []
    actions:
      - type: script_non_reviewer_alarm
        topic_urn_list:
          - 'urn:smn:cn-north-4:ce8476c174f94c6991ea7885e3380d99:itau'
        subject: 'Script Security Non-Compliance Alert'
        message: "Alert by Huawei_COC_002_CTS_Trigger : No approver is set for the script. Please handle it in time."